<div class="main-content-wrapper">
  <div class="container-fluid mt-5 pt-5">

    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="fw-bold text-dark mb-1">Consola de Citas</h2>
      <button (click)="cargarCitas()" class="btn btn-primary rounded-pill px-4 shadow-sm">
        <i class="fas fa-sync-alt me-2"></i> Actualizar
      </button>
    </div>

    <div class="card shadow-sm border-0 rounded-4 overflow-hidden">
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="bg-dark text-white">
              <tr>
                <th class="ps-4 py-3">ID</th>
                <th class="py-3">Paciente</th>
                <th class="py-3">Fecha / Hora</th>
                <th class="py-3">Precio</th>
                <th class="py-3 text-center">Estado</th>
                <th class="text-center pe-4 py-3">Acciones</th>
              </tr>
            </thead>
            <tbody>

              <tr *ngFor="let cita of citas" class="align-middle">
                <td class="ps-4 fw-bold text-primary">#{{ cita.idCita }}</td>

                <td>
                  <div class="fw-bold text-dark">{{ cita.nombrePaciente || cita.paciente?.nombre }}</div>
                  <small class="text-muted">{{ cita.emailPaciente || cita.paciente?.email }}</small>
                </td>
                <td>
                  <div class="fw-medium">
                    <i class="far fa-calendar-alt me-1 text-primary"></i>
                    {{ cita.fechaHora | date:'dd/MM/yyyy' }}
                  </div>
                  <div class="text-muted small">
                    <i class="far fa-clock me-1"></i>
                    {{ cita.fechaHora | date:'shortTime' }}
                  </div>
                </td>

                <td>
                  <span class="fw-bold">S/ {{ cita.precio | number:'1.2-2' }}</span>
                </td>

                <td class="text-center">
                  <span class="badge rounded-pill px-3 py-2 shadow-sm" [ngClass]="{
          'bg-success text-white': (cita.estadoCita?.nombre || cita.estado)?.toUpperCase() === 'COMPLETADA',
          'bg-warning text-dark': (cita.estadoCita?.nombre || cita.estado)?.toUpperCase() === 'PENDIENTE',
          'bg-danger text-white': (cita.estadoCita?.nombre || cita.estado)?.toUpperCase() === 'CANCELADA',
          'bg-secondary text-white': !(cita.estadoCita?.nombre || cita.estado)
        }">
                    <i class="fas fa-circle me-1" style="font-size: 0.5rem;"></i>
                    {{ cita.estadoCita?.nombre || cita.estado || 'PENDIENTE' }}
                  </span>
                </td>
                <td class="text-center pe-4">
                  <button *ngIf="cita.estadoCita?.nombre !== 'CANCELADA'" (click)="cancelarCita(cita.idCita)"
                    class="btn btn-outline-danger btn-sm rounded-circle">
                    <i class="fas fa-times"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>